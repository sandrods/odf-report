"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[858],{9858:(e,t,a)=>{a.r(t),a.d(t,{search:()=>o});let s=new(a(9323)).Ay.Document({tokenize:"full",document:{id:"url",index:"content",store:["title","pageTitle"]},context:{resolution:9,depth:2,bidirectional:!0}});for(let{url:e,sections:t}of[{url:"/",sections:[["Getting started",null,["Generate .odt documents from templates using simple Ruby code.","ODF-Report is a Ruby gem that generates  (OpenDocument Text) files by taking a template and replacing placeholders with data. ODF files are ZIP archives containing XML — the gem uses  for ZIP manipulation and  for XML parsing.","The workflow is simple: create a  template in LibreOffice or OpenOffice with , then use the Ruby DSL to define replacements and generate documents."]],["How it works","how-it-works",["There are five kinds of substitutions available:"]],["Quick example","quick-example",["This takes a template containing , , and a table named  with , , and  placeholders — and produces a finished document with all values filled in."]],["Next steps","next-steps",[]]]},{url:"/docs/api-reference",sections:[["API reference",null,["Complete reference for all ODF-Report methods."]],["Report","report",["","Creates a new report. Provide either a file path or an  string with the template content.","","Generates the document. If  is provided, writes to that file path. Otherwise returns the document as a binary string."]],["Fields","fields",["","Replaces all occurrences of  in the document with the given value.","Parameters:"]],["Texts","texts",["","Replaces the placeholder paragraph with HTML-formatted ODF content.","Parameters: Same as .","Works like  but parses the value as HTML and converts it into ODF paragraphs. Requires the template to define matching character/paragraph styles. See Texts and Supported HTML tags for details."]],["Tables","tables",["","Repeats table rows for each item in the collection.","Parameters:","","Alias for . Used inside table blocks for readability."]],["Sections","sections",["","Repeats the named section for each item in the collection.","Parameters:","Inside a section block, you can use , , , , and ."]],["Images","images",["","Replaces a named image frame with the specified image file.","Parameters:"]]]},{url:"/docs/data-sources",sections:[["Data sources",null,["A deep dive into how ODF-Report resolves values from your data."]],["Two contexts","two-contexts",["Values are resolved differently depending on context:"]],["Static values (report level)","static-values-report-level",["At the report level, the second argument to  is used as-is:"]],["Symbol — method call","symbol-method-call",["Pass a symbol to call that method on each collection item:","When you only pass one argument (like ), the field name is also used as the method name."]],["Array — method chain","array-method-chain",["Pass an array of symbols to chain method calls:","You can also include method-with-argument hashes in the chain:"]],["Hash — method with argument","hash-method-with-argument",["Pass a hash to call a method with an argument:"]],["Block — custom transform","block-custom-transform",["Pass a block for full control over the value:","The block receives the current record and should return the replacement value."]],["Hash records","hash-records",["When your collection contains hashes instead of objects, values are looked up by key. The lookup tries multiple key formats:","The lookup order is: the original key, lowercase string, uppercase string, then lowercase symbol."]],["Collection references in sections","collection-references-in-sections",["Inside a section, when you add a table or nested section, you pass a symbol instead of an array. This symbol is called as a method on each section item:","This is how ODF-Report connects nested data: each level resolves its collection from the parent item."]]]},{url:"/docs/fields",sections:[["Fields",null,["Fields are the simplest form of substitution — replace  text in your template with dynamic values."]],["Placeholders in the template","placeholders-in-the-template",["A field placeholder is an uppercase name surrounded by square brackets:","You can place these anywhere in your  template — in paragraphs, table cells, headers, footers, or inside sections."]],["Basic usage","basic-usage",["Use  to define a replacement:",'Every occurrence of  in the document will be replaced with "Jane Smith", and every  with "$1,234.56".']],["Auto-uppercasing","auto-uppercasing",["Field names are automatically uppercased. These are all equivalent:"]],["Using symbols for method calls","using-symbols-for-method-calls",["When used inside a table or section, you can pass a symbol as the second argument to call a method on each collection item:","When the name and method are the same (like  above), you only need to pass the name."]],["Using blocks for transforms","using-blocks-for-transforms",["Pass a block when you need to transform the value:"]],["Formatting is preserved","formatting-is-preserved",["Any formatting applied to the placeholder text in the template (font, size, color, bold, etc.) is preserved after replacement. The substituted text inherits the formatting of the original placeholder."]],["Multiline text","multiline-text",["Newlines in field values are converted to ODF line breaks:","This renders as three lines within the same paragraph. For rich HTML formatting, use Texts instead.","If you need to rename a placeholder, delete it entirely and retype it — including the brackets. Editing a placeholder in LibreOffice can insert hidden XML markup that prevents the gem from finding it."]]]},{url:"/docs/images",sections:[["Images",null,["Replace placeholder images in your template with actual image files."]],["How it works","how-it-works",["Put a mock image (any image) in your  template and give it a name. ODF-Report will replace that mock image with the actual image file you specify, preserving the size and properties from the template."]],["Naming an image in LibreOffice","naming-an-image-in-libre-office",[]],["Basic usage","basic-usage",["The image named  in the template will be replaced with ."]],["Images inside tables","images-inside-tables",["Each row gets its own image, resolved from the collection item."]],["Images inside sections","images-inside-sections",[]],["Nil images","nil-images",["If the image path is , the image frame is removed from the document entirely:"]],["Properties preserved","properties-preserved",["The following properties from the template image are kept:","Only the image content (the actual picture data) is replaced. This means you can carefully design your layout using a placeholder image and the final document will maintain the same appearance."]]]},{url:"/docs/installation",sections:[["Installation",null,["Add ODF-Report to your Ruby project."]],["Gemfile","gemfile",["Add the gem to your :","Then run:","Or install it directly:"]],["Dependencies","dependencies",["ODF-Report depends on three gems, which are installed automatically:"]],["Ruby version","ruby-version",["ODF-Report works with Ruby 2.7 and above."]],["Verifying the installation","verifying-the-installation",["After installing, you can verify everything is working:","You're ready to go. Head to the Quick start guide to create your first document."]]]},{url:"/docs/nested-structures",sections:[["Nested structures",null,["Combine sections, tables, and fields to produce complex, multi-level documents."]],["Tables inside sections","tables-inside-sections",["The most common nesting pattern — a section that repeats for each parent record, with a table inside for child records:","For each department, the section is cloned. Inside each clone, the  table is populated with ."]],["Sections inside sections","sections-inside-sections",["Sections can nest arbitrarily:","The inner section repeats for each item returned by ."]],["Three-level nesting","three-level-nesting",["Here's a real-world example — invoices containing line items, each with notes:"]],["How collection references work at each level","how-collection-references-work-at-each-level",["At each nesting level, the collection reference changes:","The key insight: at the report level you pass the actual array. Inside sections (and tables), you pass a symbol that names the method to call on each parent item."]],["Images at any level","images-at-any-level",["Images can be placed at any nesting level:"]],["Texts at any level","texts-at-any-level",["Rich HTML text works the same way inside nested structures:"]]]},{url:"/docs/quick-start",sections:[["Quick start",null,["Create your first document in two steps: prepare a template, then write Ruby code to fill it."]],["Step 1: Create a template","step-1-create-a-template",["Open LibreOffice Writer (or OpenOffice) and create a new document. Type placeholders using uppercase names surrounded by brackets:","Save the file as .","Never edit a placeholder after typing it. If you need to change  to , delete the entire  placeholder and type  from scratch. LibreOffice may insert hidden XML markup when you edit text, which prevents the placeholder from being found."]],["Step 2: Write the Ruby code","step-2-write-the-ruby-code",["This reads the template, replaces all , , and  placeholders with the provided values, and writes the result to ."]],["Two ways to generate","two-ways-to-generate",["Save to a file","Pass a file path to  to write the output directly:","Get binary data","Call  without arguments to get the document as a binary string. This is useful in web applications where you want to send the file as a download:"]],["A more complete example","a-more-complete-example",["Here's a template with fields, a table, and an image:"]],["Next steps","next-steps",[]]]},{url:"/docs/rails-integration",sections:[["Using with Rails",null,["Serve generated  documents as downloads from a Rails application."]],["Controller example","controller-example",["Use  to stream the generated document as a download:"]],["Content type","content-type",["The correct MIME type for  files is:"]],["Template location","template-location",["Store your templates somewhere accessible in your Rails app. Common locations:","Use  to build the full path:"]],["Templates from database or S3","templates-from-database-or-s3",["If your template is stored in a database, S3, or any other non-filesystem source, use the  parameter:","The  parameter accepts a string containing the raw binary content of the  file."]],["Filename with dynamic data","filename-with-dynamic-data",["Generate meaningful filenames for downloads:"]]]},{url:"/docs/sections",sections:[["Sections",null,["Sections let you repeat entire chunks of a document — including tables, images, and nested sections — for each item in a collection."]],["When to use sections","when-to-use-sections",["Use sections when you need to repeat a structure more complex than a simple table row. A section can contain paragraphs, tables, images, fields, and even other sections."]],["Creating a section in LibreOffice","creating-a-section-in-libre-office",["The section will appear with a subtle border in LibreOffice."]],["Basic usage","basic-usage",["For each invoice in , the section is cloned and its placeholders are replaced with that invoice's data."]],["Adding tables inside sections","adding-tables-inside-sections",["Sections can contain tables. When adding a table to a section, pass a symbol for the collection instead of the array itself — this symbol refers to a method on each section item:","Here,  refers to  — the collection for that particular invoice's table. Each cloned section gets its own table populated with that invoice's line items."]],["Nesting sections","nesting-sections",["Sections can contain other sections:","The inner section  is repeated for each note belonging to each invoice."]],["Images inside sections","images-inside-sections",[]],["Empty collections","empty-collections",["When the collection is  or empty, the section is removed from the document entirely. This is the default behavior — no extra option needed."]],["How data sources work in sections","how-data-sources-work-in-sections",["Inside a section block, the data source for nested elements works differently than at the report level:","See Data sources for the full explanation."]]]},{url:"/docs/supported-html",sections:[["Supported HTML tags",null,["Complete reference of HTML tags supported by ."]],["Block-level elements","block-level-elements",["These tags generate separate ODF paragraphs:"]],["Inline elements","inline-elements",["These tags apply formatting within a paragraph:"]],["HTML entities","html-entities",["HTML entities are supported and converted to their corresponding characters:"]],["Unsupported tags","unsupported-tags",["Tags not listed above are stripped — their content is preserved as plain text, but the tag itself has no effect:"]],["Style naming","style-naming",["Style names must match exactly in lowercase. The parser looks for these specific names:","Creating character styles in LibreOffice","Creating paragraph styles in LibreOffice"]],["Example with all supported tags","example-with-all-supported-tags",[]]]},{url:"/docs/tables",sections:[["Tables",null,["Generate table rows automatically from a collection of data."]],["How it works","how-it-works",["Create a table in your  template with placeholder cells. ODF-Report clones the template row for each item in your collection, replacing the placeholders in each clone."]],["Naming a table","naming-a-table",["To use a table with ODF-Report, it needs a name:"]],["Basic usage","basic-usage",["Given a template table named  with cells containing  and :","This creates one row for each employee in , with the placeholders replaced by the corresponding values.","is just an alias for . They work exactly the same way — use whichever reads better in context."]],["Column values","column-values",["Columns support the same value resolution as fields:"]],["Header rows","header-rows",["If your table has a header row, pass  to preserve it. The first row will be left untouched and only subsequent rows are used as templates:",'The header row ("Description", "Qty", "Price") stays as-is. The second row is the template.',"If your table uses the ODF  element (set via Table Properties > Text Flow > Repeat heading), the header option is automatically detected and the  parameter is not needed."]],["Removing empty tables","removing-empty-tables",["Use  to remove the entire table when the collection is empty or nil:","Without this option, an empty collection would leave the template row (with unresolved placeholders) in the document."]],["Zebra rows (alternating styles)","zebra-rows-alternating-styles",["If your template table has multiple rows below the header, they are cycled for each data item. This is useful for alternating row styles (e.g., different background colors):","ODF-Report alternates between the two template rows as it generates output, producing a zebra-striped table."]],["Formatting","formatting",["Any formatting applied to the placeholder cells in the template is preserved. Font, size, color, alignment, cell borders, and background colors all carry over to the generated rows."]]]},{url:"/docs/texts",sections:[["Texts",null,["Use  to replace placeholders with rich HTML-formatted content that gets converted into ODF paragraphs."]],["How texts differ from fields","how-texts-differ-from-fields",["While  does plain text substitution (replacing the placeholder inline),  parses HTML content and converts it into proper ODF-formatted paragraphs. This means you can use headings, bold, italic, underline, blockquotes, and line breaks."]],["Basic usage","basic-usage",["The placeholder  in your template will be replaced with two formatted paragraphs."]],["Supported HTML tags","supported-html-tags",["Block-level elements","Inline elements","For the complete reference, see Supported HTML tags."]],["Template setup","template-setup",["For inline formatting and paragraph styles to render correctly, your  template must define the corresponding styles. The parser generates ODF XML referencing these style names but does not create the style definitions itself.","Step 1: Create character styles","Open your template in LibreOffice Writer. Go to View > Styles (or press F11), then right-click on the character styles list and select New Style. Create these styles:","The style names must be lowercase and match exactly: , , . These are the names the parser references in the generated ODF XML.","Step 2: Create paragraph styles (optional)","If you plan to use , , or , create these paragraph styles:","Step 3: Place your placeholder","Type the placeholder (e.g., ) inside a normal text paragraph. This paragraph node is used as the base template for each generated paragraph."]],["Examples","examples",["Simple paragraphs","Inline formatting","Headings and quotes","Line breaks within a paragraph"]],["Using inside sections and tables","using-inside-sections-and-tables",["works inside sections and tables, resolving values per collection item:"]],["Troubleshooting","troubleshooting",["Formatting not applied: If your text appears but without bold/italic/underline, the most likely cause is that the required character styles are not defined in your template. Open the template in LibreOffice and verify that styles named exactly , , and  exist.","Placeholder not replaced: Make sure the placeholder text (e.g., ) is in a single text node. If you edit a placeholder in LibreOffice, it may split the text across multiple XML nodes. Delete the placeholder entirely and retype it."]]]},{url:"/docs/troubleshooting",sections:[["Troubleshooting",null,["Solutions to common issues when working with ODF-Report."]],["Placeholder not replaced","placeholder-not-replaced",["Symptom: Your  appears in the output document unchanged.","Cause: LibreOffice/OpenOffice sometimes inserts hidden XML markup when you edit a placeholder. Instead of a clean  text node, the XML might contain something like , which the gem can't match.","Solution: Delete the entire placeholder and retype it from scratch, including the square brackets.","Never edit placeholders. If you need to change  to , don't select and modify the text. Instead, delete  completely and type  fresh.","Additional checks:"]],["Word found unreadable content","word-found-unreadable-content",['Symptom: You create your template in LibreOffice, but when you open the generated document in Microsoft Word, it reports "Word found unreadable content."',"Solution:","Why this works: Word doesn't support all ODF features. The round-trip through  removes document features that Word can't handle."]],["Formatting not applied to texts","formatting-not-applied-to-texts",["Symptom:  content appears as plain text without bold, italic, or underline formatting.","Cause: The required character styles are not defined in your template.","Solution: Open your template in LibreOffice and create character styles named exactly , , and . See Texts — Template setup for step-by-step instructions."]],["Table not found","table-not-found",["Symptom: Table rows are not generated, or the table is left unchanged.","Cause: The table name in your code doesn't match the table name in the template.","Solution:"]],["Section not found","section-not-found",["Symptom: Section content is not repeated.","Cause: The section name doesn't match, or the section wasn't created properly.","Solution:"]],["Image not replaced","image-not-replaced",["Symptom: The placeholder image remains in the output.","Cause: The image frame name doesn't match.","Solution:"]],["Corrupted files with rubyzip 3 / Rails 8","corrupted-files-with-rubyzip-3-rails-8",["Symptom: Generated  files are corrupt and cannot be opened or recovered by LibreOffice. This typically happens after upgrading to Rails 8 or rubyzip 3.","Cause: rubyzip 3 enables Zip64 by default. The Zip64 format is not supported by  readers.","Solution: Disable Zip64 support by adding an initializer:"]],["Common mistakes","common-mistakes",["Passing an array inside a section instead of a symbol: Inside sections, use  (symbol) not  (array). The symbol tells ODF-Report to call that method on each section record.","Forgetting : If your table has a header row and you don't pass , the header row will be treated as a template row and duplicated for each item.","Editing template placeholders: Always delete and retype. Never edit in place."]]]}])for(let[a,o,n]of t)s.add({url:e+(o?"#"+o:""),title:a,content:[a,...n].join("\n"),pageTitle:o?t[0][0]:void 0});function o(e,t={}){let a=s.search(e,{...t,enrich:!0});return 0===a.length?[]:a[0].result.map(e=>({url:e.id,title:e.doc.title,pageTitle:e.doc.pageTitle}))}}}]);